FROM anapsix/alpine-java:8

ARG JAR_FILE
ARG PORT_NUMBER
ENV MY_JAR_FILE=${JAR_FILE}
ENV MY_PORT_NUMBER=${PORT_NUMBER}

ENV JAEGER_SERVICE_NAME=gateway
ENV JAEGER_REPORTER_LOG_SPANS=true
ENV JAEGER_SAMPLER_TYPE=const
ENV JAEGER_SAMPLER_PARAM=1
ENV JAEGER_ENDPOINT=http://jaeger:14268/api/traces

EXPOSE ${MY_PORT_NUMBER}
ADD target/${MY_JAR_FILE} /opt/${MY_JAR_FILE}
ENTRYPOINT java -jar /opt/${MY_JAR_FILE} -Djava.net.preferIPv4Stack=true